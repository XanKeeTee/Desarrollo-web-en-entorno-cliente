<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ejercicio1</title>
  </head>

  <body>
    <h1>Examen Javascript Tema 3</h1>
    <strong> Nombre: Miguel Angel Gambero </strong>

    <!-- *************** -->
    <h2>Ejercicio1</h2>
    <div>
      Fechas En un documento html crea un formulario con 3 controles numero que
      sean año mes y dia que cree una fecha y te indique cuantos dias han pasado
      desde el dia 01/02/1970
    </div>
    <button onclick="ejercicio1()">Ejercicio 1</button>
    <div id="resultado1"></div>
    <script>
      function ejercicio1() {
        const dia = parseInt(prompt("Dime tu día de nacimiento (1-31):"));
        const mes = parseInt(prompt("Dime tu mes de nacimiento (1-12):"));
        const anno = parseInt(prompt("Dime tu año de nacimiento (ej. 1990):"));

        const fechaUsuario = new Date(anno, mes - 1, dia);
        const fechaEjercicio = new Date("01/02/1970");

        const diferenciaMs = fechaUsuario.getTime() - fechaEjercicio.getTime();
        const diasVividos = Math.floor(diferenciaMs / (1000 * 60 * 60 * 24));

        const fechaFormateada = fechaUsuario.toLocaleDateString("es-ES");

        document.getElementById("resultado1").innerHTML = `
          <p>Fecha de nacimiento: ${fechaFormateada.toLocaleString("es-ES")}</p>
          <p>Dias desde 1970 hasta tu fecha de nacimiento : ${diasVividos}</p>
        `;
      }
    </script>
    <hr />
    <!-- *************** -->

    <h2>Ejercicio2</h2>
    <div>
      Horas. Crea un formulario que se comporte como un cronometro. Que cuando
      pulses un botón empiece a contar (Deben aparecer en un div los decimas de
      segundo) hasta que vuelvas a pulsarlo para pararlo y te cuente el numero
      de segundo y milisegundos transacurridos. Debes usar el algun metodo para
      actualizar el cronometro cada segundo.
    </div>
    <div id="cronometro">
          <span id="segundos">00</span>:<span id="milisegundos">00</span>
        </div>

        <button onclick="iniciar()">Iniciar cronometro</button>
        <button onclick="parar()">Parar cronometro</button>
        <button onclick="reiniciar()">Reiniciar cronometro</button>
    </div>
    <script>  
          let cronometro;
          let segundos = 0; 
          let milisegundos = 0; 
          let imprimirSegundos;
          let imprimirMiliSegundos;
          let estaCorriendo = false;

          function iniciar(){
            if(estaCorriendo == false) {
                estaCorriendo = true;
                cronometro = setInterval(actualizarReloj, 10);
            }
          }

          function actualizarReloj() {
            milisegundos++;

            if (milisegundos > 99) {
                milisegundos = 0;
                segundos++;
            }
            
            if (milisegundos < 10) {
                imprimirMiliSegundos = "0" + milisegundos;
            } else {
                imprimirMiliSegundos = milisegundos;
            }

            if (segundos < 10) {
                imprimirSegundos = "0" + segundos;
            } else {
                imprimirSegundos = segundos;
            }

            document.getElementById("segundos").innerText = imprimirSegundos;
            document.getElementById("milisegundos").innerText = imprimirMiliSegundos;
          }

          function parar() {
            clearInterval(cronometro); 
            estaCorriendo = false;
          }

          function reiniciar() {
            clearInterval(cronometro);
            estaCorriendo = false;
            
            segundos = 0;
            milisegundos = 0;
            
            document.getElementById("segundos").innerText = "00";
            document.getElementById("milisegundos").innerText = "00";
          }
        </script>
    <hr />
    <!-- *************** -->

    <h2>Ejercicio3</h2>
    <div>
      Number. Location Navigator. Crea un script que tome dos datos latitud y
      longitud de un formulario y los valores latitud y longitud del objeto
      navigator. Con el teorema de pitagoras Distancia = raiz (Lat2 +Long2) y
      Asumiendo que un grado terrestre es aproximadamente 111 km calcula la
      distancia a ese lugar.
    </div>
    <button onclick="ejercicio3()">Ejercicio 3</button>
    <div id="resultado3"></div>
    <script>
        function ejercicio3(){
            const latitud = parseInt(prompt("Digame la latitud: "))
            const longitud = parseInt(prompt("Digame la longitud: "))
            
            const distancia = parseInt(Math.sqrt(Math.pow(latitud,2)+Math.pow(longitud,2)));

            document.getElementById("resultado3").innerHTML = `
            <p>La distancia es de ${distancia} KM   </p>
            `;
        }
    </script>
    <hr />
    <!-- *************** -->

    <h2>Ejercicio 4</h2>
    <div>
      4. Fechas Utiliza la libreria date.js para que calcule las siguientes
      fechas<br />
      1. ayer<br />
      2. el segundo martes del mes pasado.<br />
      3. el primer domingo de octubre.<br />
      4. el primer lunes del año pasado.<br />
      5. la fecha dentro de dos años<br />
      6. la fecha de mañana a las 18:30 p. m.<br />
    </div>
    <button onclick="ejercicio4()">Ejercicio 4</button>
    <div id="resultado4"></div>
    
    <script type="text/javascript" src="./datejs/date.js"></script>
    <script>
      function ejercicio4(){
          document.getElementById("resultado4").innerHTML = `
            <p>1. ayer: ${Date.today().addDays(-1)}</p>
            <p>2. el segundo martes del mes pasado:  ${Date.today().addMonths(-1).second().tuesday()}</p>
            <p>3. el primer domingo de octubre : ${Date.october().first().sunday()}.</p>
            <p>4. el primer lunes del año pasado:${Date.january().first().monday().addYears(-1)}}.</p>
            <p>5. la fecha dentro de dos años: ${Date.today().addYears(2)}</p>
            <p>6. la fecha de mañana a las 18:30 p. m. ${Date.today().addDays(1).at("18:30")}</p>
          `;
      }
    </script>
    <hr />
    <!-- *************** -->

    <h2>Ejercicio 5</h2>
    <div>
      5. Strings . Crea un script que tome una serie de numeros<br />
      separados por coma de un control texto lo convierta<br />
      una array y lo recorra para pintar con los numeros<br />
      proporcionados como imagenes de la carpeta numbers.<br />
    </div>
    <p>
        <p>Introduce los numeros con : </p>
        <input type="text" size="60" name="input5" />
        <input
          type="button"
          name="button"
          value="Añadir al array"
          onclick="ejercicio5();"
        />
      </p>
      <div id="resultado5"></div> 
    <script>
        function ejercicio5(){
            const numerosInput = document.getElementsByName("input5")[0].value;

            const arrayNumeros = numerosInput.split(',');

            let salidaHtml = '';

            for (const numero of arrayNumeros) {
                salidaHtml += `<img src="./numeros2/${numero.trim()}.jpg">`;
            }
            document.getElementById("resultado5").innerHTML = salidaHtml;
        }
    </script>
    <hr />
    <!-- *************** -->

    <h2>Ejercicio 6</h2>
    <div>
      Number y String. Crea un formulario que tome un valor de un control color
      picker <br />
      ( puedes hacerlo con el evento onchange o un botón). <br />
      Calcule la siguiente formula para pasar de RGB a HSL y lo muestre en un
      div <br />
      (ojo el color picker te devuelve un string con el formato rrggbb ) <br />
      por lo que para hallar RGB deberas cortarlo con substring y <br />
      convertirlo a un numero o usar la funcion parseint<br />
      let r = parseInt("FF", 16); // 255
    </div>
    <br />
    <img src="hsl.jpg" /><br />
    <label for="colorPicker">Elige un color:</label>
    <input type="color" id="colorPicker" value="#ff0000" onchange="ejercicio6(this.value)">
    <div id="resultado6" style="margin-top: 10px;"></div>
    <script>
      function ejercicio6(hex) {
        let r = parseInt(hex.substring(1, 3), 16);
        let g = parseInt(hex.substring(3, 5), 16);
        let b = parseInt(hex.substring(5, 7), 16);

        r /= 255;
        g /= 255;
        b /= 255;

        const max = Math.max(r, g, b);
        const min = Math.min(r, g, b);

        let h, s, l = (max + min) / 2;

        if (max === min) {
          h = s = 0; 
        } else {
          const d = max - min;
          s = l > 0.5 ? d / (2 - max - min) : d / (max + min);

          switch (max) {
            case r:
              h = (g - b) / d + (g < b ? 6 : 0);
              break;
            case g:
              h = (b - r) / d + 2;
              break;
            case b:
              h = (r - g) / d + 4;
              break;
          }
          h /= 6;
        }

        const h_grados = Math.round(h * 360);
        const s_porcentaje = Math.round(s * 100);
        const l_porcentaje = Math.round(l * 100);

        const resultadoDiv = document.getElementById('resultado6');
        resultadoDiv.innerHTML = `Color Hex: ${hex}<br>RGB: (${parseInt(r*255)}, ${parseInt(g*255)}, ${parseInt(b*255)})<br><b>HSL: (${h_grados}°, ${s_porcentaje}%, ${l_porcentaje}%)</b>`;
        resultadoDiv.style.backgroundColor = hex;
        resultadoDiv.style.color = l_porcentaje > 50 ? 'black' : 'white'; 
      }
    </script>
    <hr />
    <!-- *************** -->

    <h2>Ejercicio 7</h2>
    <div>
      7. imagenes de Document. Crea documento con un script que te genere
      aleatoriamente entre 4 y 10 imagenes<br />
      puedes cogerlas de la carpeta de los numeros o de las cartas o si no
      quieres hacerlo variable asume que hay 5<br />
      imagenes)<br />

      Haz un metodo que te haga rotar a la derecha todas las imagenes de cada
      vez que pulses en un boton ( para ello<br />
      debes usar los objetos document.images[i].src imagen1=imagen2;
      imagen2=imagen3 .... ) y otro boton que las haga<br />
      rotar a la izquierda<br />
      Crea un ejemplo en el que se inserten varias imagenes aleatorias de la
      carpeta number y las puedas probar.<br />
    </div>
    <button onclick="ejercicio7()">Ejercicio7</button>
    <button onclick="rotarDerecha()">Rotar Derecha</button>
    <button onclick="rotarIzquierda()">Rotar Izquierda</button>
    <div id="resultado7"></div>
    <script>
        function ejercicio7(){
            const numImagenes = Math.floor(Math.random() * 7) + 4; 
            let htmlImagenes = '';

            for (let i = 0; i < numImagenes; i++) {
                const imagenAleatoria = Math.floor(Math.random() * 10);
                htmlImagenes += `<img src="./numeros2/${imagenAleatoria}.jpg">`;
            }

            document.getElementById("resultado7").innerHTML = htmlImagenes;
        }

        function rotarDerecha() {
            const contenedor = document.getElementById('resultado7');
            const imagenes = contenedor.getElementsByTagName('img');
            if (imagenes.length < 2) return; 

            const ultimoSrc = imagenes[imagenes.length - 1].src;

            for (let i = imagenes.length - 1; i > 0; i--) {
                imagenes[i].src = imagenes[i - 1].src;
            }

            imagenes[0].src = ultimoSrc;
        }

        function rotarIzquierda() {
            const contenedor = document.getElementById('resultado7');
            const imagenes = contenedor.getElementsByTagName('img');
            if (imagenes.length < 2) return;

            const primerSrc = imagenes[0].src;
            contenedor.appendChild(imagenes[0]);
            imagenes[imagenes.length - 1].src = primerSrc;
        }
    </script>
    <hr />
    <!-- *************** -->
    <h2>Ejercicio 8</h2>
    <div>
      8. Number Random. Crea un formulario que se comporte como el juego de la 7
      y media .<br />
      Cuentas con dos botones "Pedir carta" y "Parar".<br />
      <br />
      1. Cada vez que pulsas un boton "Pedir carta" debe sacar un numero
      aleatorio entre 1 y 10. Debes mostrar el<br />
      numero y usar las imagenes proporcionadas con un array.<br />

      1. Cada carta numerada del 1 al 9 (1,2, 3, 4, 5, 6, 7) tendrá un valor
      idéntico a su valor numérico.<br />
      2. Las figuras (10,11,12 Jotas, Reinas y Reyes) valen todas medio punto.
      (en el juego original el 1 vale 1 o 0.5<br />
      lo reducimos a 1 para que sea mas facil)<br />
      <br />
      2. En cada jugada el jugador puede sacar cartas o plantarse.<br />
      <br />
      3. Cuando se pulsa el botón parar el sistema genera un numero al azar
      entre 3 y 10<br />
      1. Si te pasas de 7.5 pierdes.<br />
      2. Si es mayor tu numero o el suyo es mayor de 7.5 has ganado<br />
      3. Si no has perdido.<br />
      <br />
      4. Con el resultado debes poner la imagen correcta y y si ha ganado o
      perdido y Debes poner un boton reiniciar.<br />
    </div>
    <button onclick="pedirCarta()">Pedir carta</button>
    <button onclick="plantarse()">Plantarse</button>
    <button onclick="reiniciarJuego()" id="botonReiniciar" style="display:none;">Reiniciar</button>

    <h4>Tus cartas (Puntuación: <span id="puntuacionJugador">0</span>)</h4>
    <div id="cartasJugador"></div>

    <h4>Cartas de la banca (Puntuación: <span id="puntuacionBanca">0</span>)</h4>
    <div id="cartasBanca"></div>

    <h3 id="resultadoFinal"></h3>

    <script>
      let puntuacionJugador = 0;
      let juegoTerminado = false;

      function pedirCarta() {
        if (juegoTerminado) return;

        // 1. Sacar carta aleatoria (1-12, asumiendo que hay cartas del 1 al 12)
        // No hay cartas 8 y 9 en la baraja española, así que las saltamos.
        let numeroCarta;
        do {
          numeroCarta = Math.floor(Math.random() * 12) + 1;
        } while (numeroCarta === 8 || numeroCarta === 9);

        // 2. Calcular valor y mostrar imagen
        let valorCarta = 0;
        if (numeroCarta >= 10) { // Figuras (Sota, Caballo, Rey)
          valorCarta = 0.5;
        } else { // Cartas del 1 al 7
          valorCarta = numeroCarta;
        }

        puntuacionJugador += valorCarta;
        document.getElementById('cartasJugador').innerHTML += `<img src="./cartas/${numeroCarta}.jpg" style="padding:5px; height:150px;">`;
        document.getElementById('puntuacionJugador').innerText = puntuacionJugador;

        // 3. Comprobar si el jugador se ha pasado
        if (puntuacionJugador > 7.5) {
          document.getElementById('resultadoFinal').innerText = "¡Te has pasado de 7.5! Has perdido.";
          document.getElementById('resultadoFinal').style.color = 'red';
          terminarJuego();
        }
      }

      function plantarse() {
        if (juegoTerminado) return;

        const puntuacionBanca = (Math.random() * (10 - 3) + 3).toFixed(2);

        document.getElementById('puntuacionBanca').innerText = puntuacionBanca;
        document.getElementById('cartasBanca').innerHTML = `<img src="./cartas/banca.jpg" style="padding:5px; height:150px;">`;

        // Comprobar quién ha ganado
        if (puntuacionJugador > 7.5) {
            // Esta condición ya se maneja en pedirCarta, pero por si acaso.
            document.getElementById('resultadoFinal').innerText = "Has perdido, te pasaste de 7.5.";
            document.getElementById('resultadoFinal').style.color = 'red';
        } else if (puntuacionBanca > 7.5 || puntuacionJugador > puntuacionBanca) {
            document.getElementById('resultadoFinal').innerText = "¡Has ganado!";
            document.getElementById('resultadoFinal').style.color = 'green';
        } else {
            document.getElementById('resultadoFinal').innerText = "Has perdido. La banca gana.";
            document.getElementById('resultadoFinal').style.color = 'red';
        }
        terminarJuego();
      }
      
      function terminarJuego() {
        juegoTerminado = true;
        document.getElementById('botonReiniciar').style.display = 'inline';
      }

      function reiniciarJuego() {
        // Recarga la página para reiniciar el estado del examen completo
        location.reload();
      }
    </script>
    <hr />
    <!-- *************** -->
  </body>
</html>
